<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>The Unread Cards · Minimal, Mobile‑Friendly</title>
  <style>
    :root{ --bg:#0f0f12; --panel:#15151b; --line:#24242c; --text:#f4f4f6; --muted:#a9a9b5; --accent:#e7c56f; }
    *{ box-sizing:border-box }
    body{ margin:0; font-family:ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,Arial; background:var(--bg); color:var(--text); }
    .wrap{ min-height:100svh; display:flex; align-items:center; justify-content:center; padding:16px }
    .app{ width:100%; max-width:760px; background:var(--panel); border:1px solid var(--line); border-radius:18px; box-shadow:0 8px 32px rgba(0,0,0,.4); padding:20px }
    h1{ margin:0 0 6px; font-size:24px }
    p.sub{ margin:0 0 14px; color:var(--muted); font-size:14px }

    .controls{ display:flex; gap:10px; flex-wrap:wrap; margin-bottom:14px }
    .btn{ appearance:none; border:1px solid var(--line); background:#1c1c22; color:var(--text); padding:10px 14px; border-radius:12px; font-weight:700; cursor:pointer }
    .btn.primary{ background:var(--accent); color:#141414; border:0 }
    .btn:disabled{ opacity:.6; cursor:not-allowed }

    .result{ display:none; border:1px solid var(--line); border-radius:14px; overflow:hidden; }
    .card-top{ display:flex; gap:16px; padding:16px; background:#101015; align-items:flex-start }
    .thumb{ width:180px; max-width:45vw; aspect-ratio:3/5; background:#0b0b0f; border:1px solid var(--line); border-radius:10px; overflow:hidden; display:flex; align-items:center; justify-content:center }
    .thumb img{ width:100%; height:100%; object-fit:cover; display:block }
    .meta{ flex:1; min-width:0 }
    .title{ font-size:20px; font-weight:800; display:flex; gap:8px; align-items:center; line-height:1.2; }
    .badge{ font-size:11px; padding:4px 8px; border-radius:999px; border:1px solid var(--line); color:var(--muted); white-space:nowrap }
    .desc{ margin-top:8px; line-height:1.6; font-size:15px; white-space:pre-line; max-height:42svh; overflow:auto; -webkit-overflow-scrolling:touch }
    .footer{ padding:10px 14px; background:#0e0e12; display:flex; align-items:center; justify-content:space-between; color:var(--muted); font-size:12px }

    #deckWarning{ margin-top:10px; color:#ffb3b3; font-size:13px }

    @media (max-width:600px){
      .card-top{ flex-direction:column }
      .thumb{ width:100%; max-width:none }
      .title{ font-size:18px }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="app">
      <h1>The Unread Cards</h1>
      <p class="sub">Draw a single card (upright or reversed). Long, reflective meanings are supported.</p>

      <div class="controls">
        <button id="drawBtn" class="btn primary">Draw a Card</button>
      </div>

      <section id="result" class="result" aria-live="polite">
        <div class="card-top">
          <div class="thumb">
            <img id="cardImg" alt="Tarot card image" loading="lazy" />
          </div>
          <div class="meta">
            <div class="title">
              <span id="cardTitle">—</span>
              <span id="poseBadge" class="badge">Upright</span>
            </div>
            <div id="cardDesc" class="desc">—</div>
          </div>
        </div>
        <div class="footer">
          <span id="hint">Tip: Upright and reversed have different images & meanings.</span>
        </div>
      </section>

      <p id="deckWarning" style="display:none">No deck found. Load a script that sets <code>window.DECK = [ ... ]</code> before this file.</p>
    </div>
  </div>
<script src="deck.js"></script>
  <script>
  (function(){
    const resultEl = document.getElementById('result');
    const imgEl = document.getElementById('cardImg');
    const titleEl = document.getElementById('cardTitle');
    const badgeEl = document.getElementById('poseBadge');
    const descEl = document.getElementById('cardDesc');
    const warnEl = document.getElementById('deckWarning');

    function getDeck(){ return Array.isArray(window.DECK) ? window.DECK : null; }
    function rand(n){ return Math.floor(Math.random()*n); }

    function draw(){
      const DECK = getDeck();
      if(!DECK || !DECK.length){ warnEl.style.display = 'block'; return; }
      warnEl.style.display = 'none';

      const card = DECK[rand(DECK.length)];
      const reversed = Math.random() < 0.5;

      const imgSrc = reversed ? (card.imgReversed || card.imgUpright) : (card.imgUpright || card.imgReversed);
      const text = reversed ? (card.reversedLong || card.reversed || '') : (card.uprightLong || card.upright || '');

      if(imgSrc){ imgEl.src = imgSrc; imgEl.alt = `${card.name} — ${reversed ? 'Reversed' : 'Upright'}`; }
      titleEl.textContent = card?.name || 'Unknown Card';
      badgeEl.textContent = reversed ? 'Reversed' : 'Upright';
      descEl.textContent = text || '—';

      resultEl.style.display = 'block';
      // Scroll result into view on mobile after draw
      setTimeout(()=>{ resultEl.scrollIntoView({ behavior:'smooth', block:'start' }); }, 0);
    }

    // One-button toggle behaviour
    const btn = document.getElementById('drawBtn');
    if(btn){
      // Clean previous listeners in case of hot reload
      const clone = btn.cloneNode(true);
      btn.parentNode.replaceChild(clone, btn);
      const drawBtn = clone;
      drawBtn.addEventListener('click', ()=>{ draw(); drawBtn.textContent = 'Draw Again'; });
    }

    // Show warning if the deck is missing at load
    if(!getDeck()) warnEl.style.display = 'block';
  })();
  </script>
</body>
</html>
